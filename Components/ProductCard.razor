@using MaillotStore.Models
@using MaillotStore.Services
@inject CartService CartService

@* This class combination ensures 2 products per row on small screens and 4 on medium screens and up *@
<div class="col-6 col-md-3 mb-4">
    <div class="card product-card h-100">
        <div class="product-image-container">
            <a href="/product-detail/@Product.Id">
                <img src="@Product.ImageUrl" class="card-img-top" alt="@Product.Name">
            </a>
            <AuthorizeView Roles="Influencer">
                <div class="share-icon">
                    <i class="fas fa-share-alt"></i>
                </div>
            </AuthorizeView>
        </div>
        <div class="card-body d-flex flex-column">
            <h5 class="card-title">@Product.Name</h5>
            <p class="card-text text-muted">@Product.Season</p>
            <p class="card-text fw-bold mt-auto">FCFA @Product.Price.ToString("N0") XAF</p>

            @* Restored button layout and styling *@
            <div class="d-grid gap-2">
                <a href="/product-detail/@Product.Id" class="btn btn-dark">View Details</a>
                <button class="btn btn-primary" @onclick="AddToCart">Add to Cart</button>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter]
    public Product Product { get; set; }

    private void AddToCart()
    {
        var orderItem = new OrderItem
        {
            ProductId = Product.Id,
            Product = Product,
            Quantity = 1,
            Subtotal = Product.Price
        };

        CartService.AddToCart(orderItem);
    }
}